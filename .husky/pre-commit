# Move unstaged changes to stash
git stash push --keep-index --include-untracked

# Run build
if npm run build; then
    # Add built files to staged
    git add dist

    # Move unstaged changes back from stash
    git stash pop
else
    # Move unstaged changes back from stash
    git stash pop

    exit 1
fi
